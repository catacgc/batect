


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for batect, the build and testing environments as code tool">
      
      
        <link rel="canonical" href="https://batect.dev/config/Containers.html">
      
      
        <meta name="author" content="Charles Korn">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.1">
    
    
      
        <title>Containers - batect documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.5d00201e.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.816e8abc.min.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/3rdparty/asciinema-player.css">
    
      <link rel="stylesheet" href="../assets/styles.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-63947227-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#container-definitions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://batect.dev" title="batect documentation" class="md-header-nav__button md-logo" aria-label="batect documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            batect documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Containers
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/batect/batect/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    batect/batect
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://batect.dev" title="batect documentation" class="md-nav__button md-logo" aria-label="batect documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    batect documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/batect/batect/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    batect/batect
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../index.html" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Setup.html" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../GettingStarted.html" title="Getting started tutorial" class="md-nav__link">
      Getting started tutorial
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Comparison.html" title="Comparison with other tools" class="md-nav__link">
      Comparison with other tools
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Configuration file reference
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Configuration file reference" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Configuration file reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="Overview.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="ConfigVariables.html" title="Config Variables" class="md-nav__link">
      Config Variables
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Containers
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="Containers.html" title="Containers" class="md-nav__link md-nav__link--active">
      Containers
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#additional_hostnames" class="md-nav__link">
    additional_hostnames
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional_hosts" class="md-nav__link">
    additional_hosts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build_args" class="md-nav__link">
    build_args
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build_directory" class="md-nav__link">
    build_directory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities_to_add-and-capabilities_to_drop" class="md-nav__link">
    capabilities_to_add and capabilities_to_drop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#devices" class="md-nav__link">
    devices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    dockerfile
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable_init_process" class="md-nav__link">
    enable_init_process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entrypoint" class="md-nav__link">
    entrypoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    environment
  </a>
  
    <nav class="md-nav" aria-label="environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#term" class="md-nav__link">
    TERM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-related-environment-variables" class="md-nav__link">
    Proxy-related environment variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health_check" class="md-nav__link">
    health_check
  </a>
  
    <nav class="md-nav" aria-label="health_check">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command_1" class="md-nav__link">
    command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retries" class="md-nav__link">
    retries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interval" class="md-nav__link">
    interval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start_period" class="md-nav__link">
    start_period
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image" class="md-nav__link">
    image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log_driver" class="md-nav__link">
    log_driver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log_options" class="md-nav__link">
    log_options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ports" class="md-nav__link">
    ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privileged" class="md-nav__link">
    privileged
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run_as_current_user" class="md-nav__link">
    run_as_current_user
  </a>
  
    <nav class="md-nav" aria-label="run_as_current_user">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabled" class="md-nav__link">
    enabled
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#home_directory" class="md-nav__link">
    home_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup_commands" class="md-nav__link">
    setup_commands
  </a>
  
    <nav class="md-nav" aria-label="setup_commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command_2" class="md-nav__link">
    command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working_directory" class="md-nav__link">
    working_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    volumes
  </a>
  
    <nav class="md-nav" aria-label="volumes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#local-mounts" class="md-nav__link">
    Local mounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache-mounts" class="md-nav__link">
    Cache mounts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working_directory_1" class="md-nav__link">
    working_directory
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Includes.html" title="Includes" class="md-nav__link">
      Includes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Tasks.html" title="Tasks" class="md-nav__link">
      Tasks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Expressions.html" title="Expressions" class="md-nav__link">
      Expressions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../CLIReference.html" title="CLI reference" class="md-nav__link">
      CLI reference
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../TaskLifecycle.html" title="Task lifecycle" class="md-nav__link">
      Task lifecycle
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Working with languages and developer tools
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Working with languages and developer tools" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Working with languages and developer tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/DotNetCore.html" title=".NET Core" class="md-nav__link">
      .NET Core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/Docker.html" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/Golang.html" title="Golang" class="md-nav__link">
      Golang
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/Gradle.html" title="Gradle" class="md-nav__link">
      Gradle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/Node.html" title="Node.js" class="md-nav__link">
      Node.js
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/Ruby.html" title="Ruby" class="md-nav__link">
      Ruby
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/Seq.html" title="Seq" class="md-nav__link">
      Seq
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Working with CI systems
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Working with CI systems" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Working with CI systems
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/CIGeneral.html" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/Buildkite.html" title="Buildkite" class="md-nav__link">
      Buildkite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/CircleCI.html" title="CircleCI" class="md-nav__link">
      CircleCI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/GitHubActions.html" title="GitHub Actions" class="md-nav__link">
      GitHub Actions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/TravisCI.html" title="Travis CI" class="md-nav__link">
      Travis CI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Tips and tricks
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Tips and tricks" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Tips and tricks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/IDEIntegration.html" title="IDE integration" class="md-nav__link">
      IDE integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/Performance.html" title="Performance" class="md-nav__link">
      Performance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/BuildArtifactsOwnedByRoot.html" title="Build artifacts are owned by root" class="md-nav__link">
      Build artifacts are owned by root
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/WaitingForDependenciesToBeReady.html" title="Waiting for dependencies to be ready" class="md-nav__link">
      Waiting for dependencies to be ready
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/Proxies.html" title="Proxies" class="md-nav__link">
      Proxies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/Windows.html" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Bundles.html" title="Bundles" class="md-nav__link">
      Bundles
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../SampleProjects.html" title="Sample projects" class="md-nav__link">
      Sample projects
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/batect/batect/releases" title="Release notes" class="md-nav__link">
      Release notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/batect/batect/blob/master/ROADMAP.md" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#additional_hostnames" class="md-nav__link">
    additional_hostnames
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional_hosts" class="md-nav__link">
    additional_hosts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build_args" class="md-nav__link">
    build_args
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build_directory" class="md-nav__link">
    build_directory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities_to_add-and-capabilities_to_drop" class="md-nav__link">
    capabilities_to_add and capabilities_to_drop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#devices" class="md-nav__link">
    devices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    dockerfile
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable_init_process" class="md-nav__link">
    enable_init_process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entrypoint" class="md-nav__link">
    entrypoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    environment
  </a>
  
    <nav class="md-nav" aria-label="environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#term" class="md-nav__link">
    TERM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-related-environment-variables" class="md-nav__link">
    Proxy-related environment variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health_check" class="md-nav__link">
    health_check
  </a>
  
    <nav class="md-nav" aria-label="health_check">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command_1" class="md-nav__link">
    command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retries" class="md-nav__link">
    retries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interval" class="md-nav__link">
    interval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start_period" class="md-nav__link">
    start_period
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image" class="md-nav__link">
    image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log_driver" class="md-nav__link">
    log_driver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log_options" class="md-nav__link">
    log_options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ports" class="md-nav__link">
    ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privileged" class="md-nav__link">
    privileged
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run_as_current_user" class="md-nav__link">
    run_as_current_user
  </a>
  
    <nav class="md-nav" aria-label="run_as_current_user">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabled" class="md-nav__link">
    enabled
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#home_directory" class="md-nav__link">
    home_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup_commands" class="md-nav__link">
    setup_commands
  </a>
  
    <nav class="md-nav" aria-label="setup_commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command_2" class="md-nav__link">
    command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working_directory" class="md-nav__link">
    working_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    volumes
  </a>
  
    <nav class="md-nav" aria-label="volumes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#local-mounts" class="md-nav__link">
    Local mounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache-mounts" class="md-nav__link">
    Cache mounts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working_directory_1" class="md-nav__link">
    working_directory
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/batect/batect/edit/master/docs/content/config/Containers.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="container-definitions">Container definitions<a class="headerlink" href="#container-definitions" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page reflects the options available in the <a href="https://github.com/batect/batect/releases/latest">most recent version</a>
of batect.</p>
</div>
<p>There are a number of configuration options for containers:</p>
<ul>
<li><a href="#image"><code>image</code></a>: image to use for this container. <strong>One of <code>image</code> or <code>build_directory</code> is required.</strong></li>
<li><a href="#build_directory"><code>build_directory</code></a>: path to a directory containing a Dockerfile to build and use for this container. <strong>One of <code>image</code> or <code>build_directory</code> is required.</strong></li>
<li><a href="#build_args"><code>build_args</code></a>: list of build args to use when building the image in <code>build_directory</code></li>
<li><a href="#dockerfile"><code>dockerfile</code></a>: Dockerfile to use when building the image in <code>build_directory</code></li>
<li><a href="#command"><code>command</code></a>: command to run when the container starts</li>
<li><a href="#entrypoint"><code>entrypoint</code></a>: entrypoint to use to run the container's command</li>
<li><a href="#environment"><code>environment</code></a>: environment variables for the container</li>
<li><a href="#working_directory"><code>working_directory</code></a>: working directory for the container's command</li>
<li><a href="#volumes"><code>volumes</code></a>: volume mounts to create for the container</li>
<li><a href="#devices"><code>devices</code></a>: device mounts to create for the container</li>
<li><a href="#ports"><code>ports</code></a>: ports to expose from the container to the host machine</li>
<li><a href="#dependencies"><code>dependencies</code></a>: other containers to start before starting this container</li>
<li><a href="#health_check"><code>health_check</code></a>: health check configuration for the container</li>
<li><a href="#run_as_current_user"><code>run_as_current_user</code></a>: configuration for <a href="../tips/BuildArtifactsOwnedByRoot.html">'run as current user' mode</a></li>
<li><a href="#setup_commands"><code>setup_commands</code></a>: commands to run inside the container after it has become healthy but before dependent containers start</li>
<li><a href="#privileged"><code>privileged</code></a>: enable privileged mode for the container</li>
<li><a href="#capabilities_to_add-and-capabilities_to_drop"><code>capabilities_to_add</code></a>: additional capabilities to grant to the container</li>
<li><a href="#capabilities_to_add-and-capabilities_to_drop"><code>capabilities_to_drop</code></a>: additional capabilities to remove from the container</li>
<li><a href="#enable_init_process"><code>enable_init_process</code></a>: enable Docker's init process for the container</li>
<li><a href="#additional_hostnames"><code>additional_hostnames</code></a>: other hostnames to associate with the container, in addition to the container's name</li>
<li><a href="#additional_hosts"><code>additional_hosts</code></a>: extra entries to add to <code>/etc/hosts</code> inside the container</li>
<li><a href="#log_driver"><code>log_driver</code></a>: Docker log driver to use when running the container</li>
<li><a href="#log_options"><code>log_options</code></a>: additional options for the log driver in use</li>
</ul>
<h2 id="additional_hostnames"><code>additional_hostnames</code><a class="headerlink" href="#additional_hostnames" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--network-alias</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>extra_hosts</code></small></p>
<p>List of hostnames to associate with this container, in addition to the default hostname (the name of the container).</p>
<p>For example, <code>my-container</code> will be reachable by other containers running as part of the same task at both <code>my-container</code> and <code>other-name</code> with the following configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">additional_hostnames</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">other-name</span>
</code></pre></div>

<h2 id="additional_hosts"><code>additional_hosts</code><a class="headerlink" href="#additional_hosts" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--add-host</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>networks.aliases</code></small></p>
<p>Additional hostnames to add to <code>/etc/hosts</code> in the container. Equivalent to <code>--add-host</code> option for <code>docker run</code>.</p>
<p>For example, to configure processes inside <code>my-container</code> to resolve <code>database.example.com</code> to <code>1.2.3.4</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">additional_hosts</span><span class="p">:</span>
      <span class="nt">database.example.com</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1.2.3.4</span>
</code></pre></div>

<h2 id="build_args"><code>build_args</code><a class="headerlink" href="#build_args" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--build-arg</code> to <code>docker build</code>, <strong>equivalent Docker Compose option</strong>: <code>build.args</code></small></p>
<p>List of build args (in <code>name: value</code> format) to use when building the image in <a href="#build_directory"><code>build_directory</code></a>. Values can be <a href="Expressions.html">expressions</a>.</p>
<p>Each build arg must be defined in the Dockerfile with an <code>ARG</code> instruction otherwise the value provided will have no effect.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use caution when using build args for secret values. Build arg values can be revealed by anyone with a copy of the image with the <code>docker history</code> command.</p>
</div>
<p>For example, to set the <code>message</code> build arg to <code>hello</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">build_args</span><span class="p">:</span>
      <span class="nt">message</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello</span>
</code></pre></div>

<h2 id="build_directory"><code>build_directory</code><a class="headerlink" href="#build_directory" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: argument to <code>docker build</code>, <strong>equivalent Docker Compose option</strong>: <code>build</code> or <code>build.context</code></small></p>
<p>Path (relative to the configuration file's directory) to a directory containing a Dockerfile to build and use as an image for this container.
<strong>One of <code>image</code> or <code>build_directory</code> is required.</strong></p>
<p>Value can be an <a href="Expressions.html">expression</a>.</p>
<p>On Windows, <code>build_directory</code> can use either Windows-style (<code>path\to\thing</code>) or Unix-style (<code>path/to/thing</code>) paths, but for compatibility
with users running on other operating systems, using Unix-style paths is recommended.</p>
<p>The image can be overridden when running a task with <a href="../CLIReference.html#override-the-image-used-by-a-container-override-image"><code>--override-image</code></a>.</p>
<p>The <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#build-cache">Docker build cache</a> is used during the build process,
so if the image definition has not changed since the last build, the image will not be rebuilt, saving time.</p>
<p>For example, running the container <code>my_container</code> from the following configuration will first build the Dockerfile in the <code>.batect/my-container</code> directory, then run the resulting image:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">build_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.batect/my-container</span>
</code></pre></div>

<h2 id="capabilities_to_add-and-capabilities_to_drop"><code>capabilities_to_add</code> and <code>capabilities_to_drop</code><a class="headerlink" href="#capabilities_to_add-and-capabilities_to_drop" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--cap-add</code> / <code>--cap-drop</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>cap_add</code> / <code>cap_drop</code></small></p>
<p>List of <a href="http://man7.org/linux/man-pages/man7/capabilities.7.html">capabilities</a> to add or drop for the container.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">capabilities_to_add</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CAP_SYS_ADMIN</span>
    <span class="nt">capabilities_to_drop</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CAP_KILL</span>
</code></pre></div>

<h2 id="command"><code>command</code><a class="headerlink" href="#command" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: argument to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>command</code></small></p>
<p>Command to run when the container starts.</p>
<p>If not provided, the default command for the image will be run.</p>
<p>Both of these can be overridden for an individual task by specifying a <a href="Tasks.html#run"><code>command</code> at the task level</a>.</p>
<p>For example, running the container <code>my-container</code> from the following configuration will run the command <code>echo 'Hello world'</code>, and not the default command specified in the <code>my-image</code> image:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-image</span>
    <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &#39;Hello world&#39;</span>
</code></pre></div>

<p><a name="command-entrypoint-note"></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep in mind that this command is passed to the image's <code>ENTRYPOINT</code>, just like it would when using <code>docker run &lt;image&gt; &lt;command&gt;</code>
directly.</p>
<p>This means that if the entrypoint is not set or is not a shell, standard shell syntax features like <code>$MY_ENVIRONMENT_VARIABLE</code> and <code>&amp;&amp;</code> might not work.</p>
<p>See the Docker docs for <a href="https://docs.docker.com/engine/reference/builder/#cmd"><code>CMD</code></a> and
<a href="https://docs.docker.com/engine/reference/builder/#entrypoint"><code>ENTRYPOINT</code></a> for more details.</p>
<p>If you would like to use shell syntax features in your command, you have four options:</p>
<ol>
<li>
<p>Create a shell script and invoke that instead of specifying the command directly.</p>
</li>
<li>
<p>Wrap your command in a shell invocation.</p>
<p>For example, if your command is <code>echo hello &amp;&amp; echo world</code>, set <code>command</code> to <code>sh -c 'echo hello &amp;&amp; echo world'</code>.</p>
</li>
<li>
<p>Set the entrypoint in the image to a shell. For example:
   <div class="highlight"><pre><span></span><code><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">]</span>
</code></pre></div></p>
</li>
<li>
<p>Set the <a href="#entrypoint">entrypoint</a> for the container to a shell. For example:
   <div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">container-1</span><span class="p">:</span>
    <span class="nt">command</span><span class="p">:</span> <span class="s">&quot;&#39;echo</span><span class="nv"> </span><span class="s">hello</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">world&#39;&quot;</span> <span class="c1"># Single quotes so that whole command is treated as a single argument when passed to sh, double quotes so that YAML preserves the single quotes</span>
    <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/bin/sh -c</span>
</code></pre></div></p>
</li>
</ol>
<p>Note that for both options 3 and 4, you must quote the command so that it is passed to <code>sh -c</code> as a single argument (we want the final command line to be <code>sh -c 'echo hello &amp;&amp; echo world'</code>, not
<code>sh -c echo hello &amp;&amp; echo world</code>).</p>
</div>
<h2 id="dependencies"><code>dependencies</code><a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: none, <strong>equivalent Docker Compose option</strong>: <code>depends_on</code> (behaviour differs)</small></p>
<p>List of other containers that should be started and healthy before starting this container.</p>
<p>If a dependency's image does not contain a <a href="https://docs.docker.com/engine/reference/builder/#healthcheck">health check</a>, then as soon as it has started,
it is considered to be healthy.</p>
<p>See <a href="../tips/WaitingForDependenciesToBeReady.html">this page</a> for more information on how to ensure dependencies are ready before starting containers that
depend on them.</p>
<p>For example, running the container <code>application</code> from the following configuration will first run the <code>database</code> container and <a href="../tips/WaitingForDependenciesToBeReady.html">wait for it to become healthy</a>
before starting the <code>application</code> container:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">application</span><span class="p">:</span>
    <span class="nt">build_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.batect/application</span>
    <span class="nt">dependencies</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">database</span>

  <span class="nt">database</span><span class="p">:</span>
    <span class="nt">build_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.batect/database</span>
</code></pre></div>

<h2 id="devices"><code>devices</code><a class="headerlink" href="#devices" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--device</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>devices</code></small></p>
<p>List of device mounts to create for the container.</p>
<p>Two formats are supported:</p>
<ul>
<li>
<p><code>local:container</code> or <code>local:container:options</code> format</p>
</li>
<li>
<p>An expanded format:
  <div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">devices</span><span class="p p-Indicator">:</span>
    <span class="c1"># This is equivalent to /dev/sda:/dev/disk:r</span>
    <span class="p p-Indicator">-</span> <span class="nt">local</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/dev/sda</span>
      <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/dev/disk</span>
      <span class="nt">options</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">r</span>
</code></pre></div></p>
</li>
</ul>
<p>Note that the <code>local</code> device mounts will be different for Windows and Unix-like hosts. See the <a href="https://docs.docker.com/engine/reference/commandline/run/#add-host-device-to-container---device">Docker guide for adding host devices to containers</a> for more information.</p>
<h2 id="dockerfile"><code>dockerfile</code><a class="headerlink" href="#dockerfile" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--file</code> to <code>docker build</code>, <strong>equivalent Docker Compose option</strong>: <code>build.dockerfile</code></small></p>
<p>Dockerfile (relative to <a href="#build_directory"><code>build_directory</code></a>) to use when building the image in <a href="#build_directory"><code>build_directory</code></a>. Defaults to <code>Dockerfile</code> if not set.</p>
<p>The Dockerfile must be within <a href="#build_directory"><code>build_directory</code></a>.</p>
<p><code>dockerfile</code> must always be specified with Unix-style (<code>path/to/thing</code>) paths, even when running on Windows.</p>
<p>For example, running the container <code>my_container</code> from the following configuration will build the image given by the Dockerfile stored at <code>.batect/my-container/my-custom-Dockerfile</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">build_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.batect/my-container</span>
    <span class="nt">dockerfile</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-custom-Dockerfile</span>
</code></pre></div>

<h2 id="enable_init_process"><code>enable_init_process</code><a class="headerlink" href="#enable_init_process" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--init</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>init</code></small></p>
<p>Set to <code>true</code> to pass the <a href="https://docs.docker.com/engine/reference/run/#specify-an-init-process"><code>--init</code></a> flag when running the container.
Defaults to <code>false</code>.</p>
<p>This creates the container with a simple PID 1 process to handle the responsibilities of the init system, which is required for some applications to behave correctly.</p>
<p><a href="https://engineeringblog.yelp.com/2016/01/dumb-init-an-init-for-docker.html">Read this article</a> to understand more about the behaviour
of different processes running as PID 1 and why this flag was introduced.</p>
<p>For example, running the container <code>build-env</code> from the following configuration will launch a container that uses the <code>node:10.10.0-alpine</code> image with Docker's default init process as PID 1:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">build-env</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">node:10.10.0-alpine</span>
    <span class="nt">enable_init_process</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>

<h2 id="entrypoint"><code>entrypoint</code><a class="headerlink" href="#entrypoint" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--entrypoint</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>entrypoint</code></small></p>
<p>Entrypoint to use to run <a href="#command">command</a> or the image's default command if <code>command</code> is not provided.</p>
<p>If not provided, the default entrypoint for the image will be used.</p>
<p>Both of these can be overridden for an individual task by specifying an <a href="Tasks.html#entrypoint"><code>entrypoint</code> at the task level</a>.</p>
<p>See the Docker docs for <a href="https://docs.docker.com/engine/reference/builder/#cmd"><code>CMD</code></a> and
<a href="https://docs.docker.com/engine/reference/builder/#entrypoint"><code>ENTRYPOINT</code></a> for more information on how the entrypoint is used.
batect will always convert the entrypoint provided here to the exec form when passed to Docker.</p>
<p>For example, the container <code>my-container</code> from the following configuration will use <code>sh -c</code> as its entrypoint and ignore the default entrypoint set in <code>my-image</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-image</span>
    <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sh -c</span>
</code></pre></div>

<h2 id="environment"><code>environment</code><a class="headerlink" href="#environment" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--env</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>environment</code></small></p>
<p>List of environment variables (in <code>name: value</code> format) for the container.</p>
<p>Values can be <a href="Expressions.html">expressions</a>.</p>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p>Let's assume we have the following configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">build-env</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ruby:2.4.3</span>
    <span class="nt">environment</span><span class="p">:</span>
      <span class="nt">COUNTRY</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Australia</span>
      <span class="nt">SUPER_SECRET_VALUE</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$SECRET_PASSWORD</span>
      <span class="nt">OPTIMISATION_LEVEL</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${HOST_OPTIMISATION_LEVEL:-none}</span>
</code></pre></div>

<p>Running the container <code>build-env</code> will launch a container that uses the <code>ruby:2.4.3</code> image with the following environment variables:</p>
<ul>
<li>
<p>The environment variable <code>COUNTRY</code> will have value <code>Australia</code>.</p>
</li>
<li>
<p>The environment variable <code>SUPER_SECRET_VALUE</code> will have the value of the <code>SECRET_PASSWORD</code> environment variable on
  the host. (So, for example, if <code>SECRET_PASSWORD</code> is <code>abc123</code> on the host, then <code>SUPER_SECRET_VALUE</code> will have the value <code>abc123</code> in the container.)</p>
<p>If <code>SECRET_PASSWORD</code> is not set on the host, batect will show an error message and not start the task.</p>
</li>
<li>
<p>The environment variable <code>OPTIMISATION_LEVEL</code> will have the value of the <code>HOST_OPTIMISATION_LEVEL</code> environment variable on the host.</p>
<p>If <code>HOST_OPTIMISATION_LEVEL</code> is not set on the host, then <code>OPTIMISATION_LEVEL</code> will have the value <code>none</code> in the container.</p>
</li>
</ul>
<h3 id="term"><code>TERM</code><a class="headerlink" href="#term" title="Permanent link">&para;</a></h3>
<p>The <code>TERM</code> environment variable, if set on the host, is always automatically passed through to the container. This ensures that features such as
coloured output continue to work correctly inside the container.</p>
<h3 id="proxy-related-environment-variables">Proxy-related environment variables<a class="headerlink" href="#proxy-related-environment-variables" title="Permanent link">&para;</a></h3>
<p>Proxy-related environment variables, if set on the host, are passed through to the container at build and run time, but are not used for image pulls.</p>
<p>If a proxy-related environment variable is defined on the container's configuration, it takes precedence over the host-provided value.</p>
<p>See <a href="../tips/Proxies.html">this page</a> for more information on using batect with proxies.</p>
<h2 id="health_check"><code>health_check</code><a class="headerlink" href="#health_check" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--health-cmd</code>, <code>--health-interval</code>, <code>--health-retries</code> and <code>--health-start-period</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>healthcheck</code></small></p>
<p>Overrides the <a href="https://docs.docker.com/engine/reference/builder/#healthcheck">health check configuration</a> specified in the image:</p>
<h3 id="command_1"><code>command</code><a class="headerlink" href="#command_1" title="Permanent link">&para;</a></h3>
<p>The command to run to check the health of the container.</p>
<p>If this command exits with code 0, the container is considered healthy, otherwise the container is considered unhealthy.</p>
<h3 id="retries"><code>retries</code><a class="headerlink" href="#retries" title="Permanent link">&para;</a></h3>
<p>The number of times to perform the health check before considering the container unhealthy.</p>
<h3 id="interval"><code>interval</code><a class="headerlink" href="#interval" title="Permanent link">&para;</a></h3>
<p>The interval between runs of the health check.</p>
<p>Accepts values such as <code>2s</code> (two seconds) or <code>1m</code> (one minute).</p>
<h3 id="start_period"><code>start_period</code><a class="headerlink" href="#start_period" title="Permanent link">&para;</a></h3>
<p>The time to wait before failing health checks count against the retry count. During this period, the health check still runs,
and if the check succeeds during this time, the container is immediately considered healthy.</p>
<p>Accepts values such as <code>2s</code> (two seconds) or <code>1m</code> (one minute).</p>
<h3 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h3>
<p>The following configuration uses a fictional <code>is-healthy</code> command every two seconds to determine if the container is healthy.
After an initial three second waiting period, the container will be declared unhealthy if it fails the health check five more times.</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">health_check</span><span class="p">:</span>
      <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">is-healthy localhost:8080</span>
      <span class="nt">interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2s</span>
      <span class="nt">retries</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
      <span class="nt">start_period</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3s</span>
</code></pre></div>

<h2 id="image"><code>image</code><a class="headerlink" href="#image" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: argument to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>image</code></small></p>
<p>Image name (in standard Docker image reference format) to use for this container. <strong>One of <code>image</code> or <code>build_directory</code> is required.</strong></p>
<p>If the image has not already been pulled, batect will pull it before starting the container.</p>
<p>The image can be overridden from the command line when running a task with <a href="../CLIReference.html#override-the-image-used-by-a-container-override-image"><code>--override-image</code></a>.</p>
<p>For example, the container <code>my-container</code> from the following configuration will use the <code>ruby:2.4.3</code> image:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ruby:2.4.3</span>
</code></pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is highly recommended that you specify a specific image version, and not use <code>latest</code>, to ensure that the same image is used
everywhere. For example, use <code>alpine:3.7</code>, not <code>alpine</code> or <code>alpine:latest</code>.</p>
</div>
<h2 id="log_driver"><code>log_driver</code><a class="headerlink" href="#log_driver" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--log-driver</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>logging.driver</code></small></p>
<p>The Docker log driver to use when running the container.</p>
<p>Defaults to <code>json-file</code> if not set.</p>
<p>A full list of built-in log drivers is available in <a href="https://docs.docker.com/config/containers/logging/configure/#supported-logging-drivers">the logging section of Docker documentation</a>,
and <a href="https://docs.docker.com/config/containers/logging/plugins/">logging plugins</a> can be used as well.</p>
<p>Options for the log driver can be provided with <a href="#log_options"><code>log_options</code></a>.</p>
<p>For example, the container <code>my-container</code> from the following configuration will use the <code>syslog</code> log driver:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">log_driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">syslog</span>
</code></pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Some log drivers do not support streaming container output to the console, as described in
<a href="https://docs.docker.com/config/containers/logging/configure/#limitations-of-logging-drivers">the limitations section of Docker's logging documentation</a>.</p>
<p>If the selected log driver does not support streaming container output to the console, you will see error messages similar to
<code>Error attaching: configured logging driver does not support reading</code> in batect's output. This does not affect the execution of the task, which
will run to completion as per normal.</p>
</div>
<h2 id="log_options"><code>log_options</code><a class="headerlink" href="#log_options" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--log-opt</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>logging.options</code></small></p>
<p>Options to provide to the Docker log driver used when running the container.</p>
<p>For example, to set <a href="https://docs.docker.com/config/containers/logging/log_tags/">the tag used to identify the container in logs</a>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">log_options</span><span class="p">:</span>
      <span class="nt">tag</span><span class="p">:</span> <span class="s">&quot;my-container&quot;</span>
</code></pre></div>

<p>The options available for each log driver are described in the Docker documentation for that log driver, such as
<a href="https://docs.docker.com/config/containers/logging/json-file/">this page</a> for the <code>json-file</code> driver.</p>
<h2 id="ports"><code>ports</code><a class="headerlink" href="#ports" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--publish</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>ports</code></small></p>
<p>List of ports to make available to the host machine.</p>
<p>Three formats are supported:</p>
<ul>
<li>
<p><code>local:container</code> or <code>local:container/protocol</code> format</p>
<p>For example, <code>1234:5678</code> or <code>1234:5678/tcp</code> will make TCP port 5678 inside the container available on the host machine at TCP port 1234, and
<code>1234:5678/udp</code> will make UDP port 5678 inside the container available on the host machine at UDP port 1234.</p>
</li>
<li>
<p><code>local_from-local_to:container_from:container-to</code> or <code>local_from-local_to:container_from:container-to/protocol</code> format</p>
<p>For example, <code>1000-1001:2025-2026</code> or <code>1000-1001:2025-2026/tcp</code> will make TCP port 2025 inside the container available
on the host machine at TCP port 1000, and TCP port 2026 inside the container available on the host machine at TCP port 1001.</p>
</li>
<li>
<p>An expanded format:
  <div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">ports</span><span class="p p-Indicator">:</span>
      <span class="c1"># This is equivalent to 1234:5678 or 1234:5678/tcp</span>
      <span class="p p-Indicator">-</span> <span class="nt">local</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1234</span>
        <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5678</span>
      <span class="c1"># This is equivalent to 3000:4000/udp</span>
      <span class="p p-Indicator">-</span> <span class="nt">local</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3000</span>
        <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4000</span>
        <span class="nt">protocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">udp</span>
      <span class="c1"># This is equivalent to 1000-1001:2025-2026 or 1000-1001:2025-2026/tcp</span>
      <span class="p p-Indicator">-</span> <span class="nt">local</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000-1001</span>
        <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2025-2026</span>
      <span class="c1"># This is equivalent to 5000-5001:6025-6026/udp</span>
      <span class="p p-Indicator">-</span> <span class="nt">local</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5000-5001</span>
        <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6025-6026</span>
        <span class="nt">protocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">udp</span>
</code></pre></div></p>
</li>
</ul>
<p>All protocols supported by Docker are supported. The default protocol is TCP if none is provided.</p>
<p>The port does not need to have a corresponding <code>EXPOSE</code> instruction in the Dockerfile.</p>
<p>For example, the <code>my-container</code> container in the following configuration allows accessing port 5678 from the container on port 1234 on the host machine:</p>
<div class="highlight"><pre><span></span><code><span class="nt">container</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">1234:5678</span>
      <span class="c1"># or</span>
      <span class="p p-Indicator">-</span> <span class="nt">local</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1234</span>
        <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5678</span>
</code></pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Exposing ports is only required if you need to access the container from the host machine.</p>
<p>Any container started as part of a task will be able to access any port on any other container at the address <code>container_name:container_port</code>, even if that port
is not listed in <code>ports</code>.</p>
<p>For example, if a process running in the <code>http-server</code> container listens on port 2000, any other container in the task can access that at <code>http-server:2000</code>
without port 2000 being listed in <code>ports</code> (or an <code>EXPOSE</code> Dockerfile instruction).</p>
</div>
<h2 id="privileged"><code>privileged</code><a class="headerlink" href="#privileged" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--privileged</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>privileged</code></small></p>
<p>Set to <code>true</code> to run the container in <a href="https://docs.docker.com/engine/reference/commandline/run/#full-container-capabilities---privileged">privileged mode</a>. Defaults to <code>false</code>.</p>
<p>See also <a href="#capabilities_to_add-and-capabilities_to_drop"><code>capabilities_to_add</code> and <code>capabilities_to_drop</code></a>.</p>
<p>For example, the following configuration runs the <code>my-container</code> container in privileged mode:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">privileged</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>

<h2 id="run_as_current_user"><code>run_as_current_user</code><a class="headerlink" href="#run_as_current_user" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: none, <strong>equivalent Docker Compose option</strong>: none</small></p>
<p>Run the container with the same UID and GID as the user running batect (rather than the user the Docker daemon runs as, which is root
on Linux). This means that any files created by the container will be owned by the user running batect, rather than root.</p>
<p>This is really only useful on Linux. On macOS, the Docker daemon runs as the currently logged-in user and so any files created in the container are owned
by that user, so this is less of an issue. However, for consistency, the same configuration changes are made on both Linux and macOS.</p>
<p>See <a href="../tips/BuildArtifactsOwnedByRoot.html">this page</a> for more information on the effects of this option and why it is necessary.</p>
<p><code>run_as_current_user</code> has the following options:</p>
<h3 id="enabled"><code>enabled</code><a class="headerlink" href="#enabled" title="Permanent link">&para;</a></h3>
<p>Set to <code>true</code> to enable 'run as current user' mode. Defaults to <code>false</code>.</p>
<h3 id="home_directory"><code>home_directory</code><a class="headerlink" href="#home_directory" title="Permanent link">&para;</a></h3>
<p>Directory to use as home directory for user inside container.</p>
<p>Required if <code>enabled</code> is <code>true</code>, not allowed if <code>enabled</code> is <code>false</code>.</p>
<p>This directory is automatically created by batect with the correct owner and group.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the directory given by <code>home_directory</code> already exists inside the image for this container, it is overwritten.</p>
</div>
<h3 id="example_2">Example<a class="headerlink" href="#example_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ruby:2.4.3</span>
    <span class="nt">run_as_current_user</span><span class="p">:</span>
      <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">home_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/home/container-user</span>
</code></pre></div>

<h2 id="setup_commands"><code>setup_commands</code><a class="headerlink" href="#setup_commands" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: none, <strong>equivalent Docker Compose option</strong>: none</small></p>
<p>List of commands to run inside the container after it has become healthy but before dependent containers start.</p>
<p>See <a href="../TaskLifecycle.html">the task lifecycle</a> for more information on the effects of this option.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is recommended that you try to include any setup work in your image's Dockerfile wherever possible (and not use setup commands). Setup commands must be
run every time the container starts whereas commands included in your image's Dockerfile only run when the image needs to be built, reducing the time taken
for tasks to start.</p>
</div>
<p>Each setup command has the following options:</p>
<h3 id="command_2"><code>command</code><a class="headerlink" href="#command_2" title="Permanent link">&para;</a></h3>
<p>The command to run. <strong>Required.</strong></p>
<p>This command is run in a similar way to the container's <a href="#command"><code>command</code></a>, so the same limitations apply to using shell syntax such as <code>&amp;&amp;</code>.</p>
<h3 id="working_directory"><code>working_directory</code><a class="headerlink" href="#working_directory" title="Permanent link">&para;</a></h3>
<p>The working directory to use for the command.</p>
<p>If no working directory is provided, <a href="#working_directory"><code>working_directory</code></a> is used if it is set, otherwise the image's default working directory is used.
If this container is used as the task container and the task overrides the default working directory, that override is ignored when running setup commands.</p>
<p>The command will inherit the same environment variables as the container's <code>command</code> (including any specified on the task if this is the task container), runs as the
same <a href="#run_as_current_user">user and group</a> as the container's <code>command</code> and inherits the same settings for <a href="#privileged">privileged status</a> and
<a href="#capabilities_to_add-and-capabilities_to_drop">capabilities</a>.</p>
<h3 id="example_3">Example<a class="headerlink" href="#example_3" title="Permanent link">&para;</a></h3>
<p>Let's assume we have the following configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">database</span><span class="p">:</span>
    <span class="nt">setup_commands</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./apply-migrations.sh</span>

  <span class="nt">application</span><span class="p">:</span>
    <span class="nt">dependencies</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">database</span>
</code></pre></div>

<p>Running the container <code>application</code> will first build or pull the images for both the <code>database</code> and <code>application</code> containers.</p>
<p>Once the image for <code>database</code> is ready, <code>database</code> will start and launch the command specified in the Dockerfile, then batect will wait for the container to report as healthy.
Once <code>database</code> reports as healthy, it will run <code>./apply-migrations.sh</code> and wait for it to finish before then starting <code>application</code>.</p>
<h2 id="volumes"><code>volumes</code><a class="headerlink" href="#volumes" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--volume</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>volumes</code></small></p>
<p>List of volume mounts to create for the container.</p>
<p>Both local mounts (mounting a directory on the host into a container) and <a href="../tips/Performance.html#cache-volumes">cache mounts</a> are supported:</p>
<h3 id="local-mounts">Local mounts<a class="headerlink" href="#local-mounts" title="Permanent link">&para;</a></h3>
<p>Two formats are supported:</p>
<ul>
<li>
<p><code>local:container</code> or <code>local:container:options</code> format</p>
</li>
<li>
<p>An expanded format:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">volumes</span><span class="p p-Indicator">:</span>
      <span class="c1"># This is equivalent to .:/code:cached</span>
      <span class="p p-Indicator">-</span> <span class="nt">local</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
        <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/code</span>
        <span class="nt">options</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cached</span>
</code></pre></div>

</li>
</ul>
<p>In both formats, the following fields are supported:</p>
<ul>
<li>
<p><code>local</code>: path to the local file or directory to mount. Can be an <a href="Expressions.html">expression</a> when using the expanded format. Required.</p>
<p>Relative paths will be resolved relative to the current configuration file's directory.</p>
<p>On Windows, the local path can use either Windows-style (<code>path\to\thing</code>) or Unix-style (<code>path/to/thing</code>) paths, but for compatibility
with users running on other operating systems, using Unix-style paths is recommended.</p>
</li>
<li>
<p><code>container</code>: path to mount the local file or directory at inside the container. Required.</p>
</li>
<li><code>options</code>: standard Docker mount options (such as <code>ro</code> for read-only). Optional.</li>
</ul>
<p>Using <code>options: cached</code> may improve performance when running on macOS and Windows hosts - see <a href="../tips/Performance.html#io-performance">this page</a> for further explanation.</p>
<h3 id="cache-mounts">Cache mounts<a class="headerlink" href="#cache-mounts" title="Permanent link">&para;</a></h3>
<p>Cache mounts provide persistence between task runs without the performance overhead of mounting a directory from the host into the container.</p>
<p>They are perfect for directories such as <code>node_modules</code> which contain downloaded dependencies that can safely be reused for each task run.</p>
<p>The format for a cache mount is:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">volumes</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cache</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">node-modules</span>
        <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/code/node_modules</span>
</code></pre></div>

<p>The following fields are supported:</p>
<ul>
<li><code>type</code>: must be set to <code>cache</code>. Required.</li>
<li><code>name</code>: name of the cache, must be a valid Docker volume name. The same name can be used to share a cache between multiple containers. Required.</li>
<li><code>container</code>: path to mount the cache directory at inside the container. Required.</li>
<li><code>options</code>: standard Docker mount options (such as <code>ro</code> for read-only). Optional.</li>
</ul>
<h2 id="working_directory_1"><code>working_directory</code><a class="headerlink" href="#working_directory_1" title="Permanent link">&para;</a></h2>
<p><small><strong>Equivalent Docker CLI option</strong>: <code>--workdir</code> to <code>docker run</code>, <strong>equivalent Docker Compose option</strong>: <code>working_dir</code></small></p>
<p>Working directory to start the container in.</p>
<p>If not provided, the default working directory for the image will be used.</p>
<p>Both of these can be overridden for an individual task by specifying a <a href="Tasks.html#run"><code>working_directory</code> at the task level</a>.</p>
<p>For example, the container <code>my-container</code> in the following configuration will start with the working directory set to <code>/somewhere</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">containers</span><span class="p">:</span>
  <span class="nt">my-container</span><span class="p">:</span>
    <span class="nt">working_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/somewhere</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="ConfigVariables.html" title="Config Variables" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Config Variables
              </div>
            </div>
          </a>
        
        
          <a href="Includes.html" title="Includes" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Includes
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017-2020 Charles Korn. Documentation uses <a href="https://twemoji.twitter.com/">Twemoji</a>, licensed under the CC-BY 4.0 license.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/batect/batect" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://spectrum.chat/batect" target="_blank" rel="noopener" title="spectrum.chat" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.592d4e23.min.js"></script>
      <script src="../assets/javascripts/bundle.073197b2.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.01088dc6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../assets/3rdparty/asciinema-player.js"></script>
      
    
  </body>
</html>